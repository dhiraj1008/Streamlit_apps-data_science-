# Import libraries
######################
import numpy as np
import pandas as pd
import streamlit as st
import joblib
from PIL import Image
from rdkit import Chem
from rdkit.Chem import Descriptors
import requests
import io
######################
# Custom function
######################
## Calculate molecular descriptors
def AromaticProportion(m):
  aromatic_atoms = [m.GetAtomWithIdx(i).GetIsAromatic() for i in range(m.GetNumAtoms())]
  aa_count = []
  for i in aromatic_atoms:
    if i==True:
      aa_count.append(1)
  AromaticAtom = sum(aa_count)
  HeavyAtom = Descriptors.HeavyAtomCount(m)
  AR = AromaticAtom/HeavyAtom
  return AR

def generate(smiles, verbose=False):

    moldata= []
    for elem in smiles:
        mol=Chem.MolFromSmiles(elem)
        moldata.append(mol)

    baseData= np.arange(1,1)
    i=0
    for mol in moldata:

        desc_MolLogP = Descriptors.MolLogP(mol)
        desc_MolWt = Descriptors.MolWt(mol)
        desc_NumRotatableBonds = Descriptors.NumRotatableBonds(mol)
        desc_AromaticProportion = AromaticProportion(mol)

        row = np.array([desc_MolLogP,
                        desc_MolWt,
                        desc_NumRotatableBonds,
                        desc_AromaticProportion])

        if(i==0):
            baseData=row
        else:
            baseData=np.vstack([baseData, row])
        i=i+1

    columnNames=["MolLogP","MolWt","NumRotatableBonds","AromaticProportion"]
    descriptors = pd.DataFrame(data=baseData,columns=columnNames)
    return descriptors

######################
# Page Title
######################


url_icon="data:image/jpeg;base64,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"
response = requests.get(url_icon)
image = Image.open(io.BytesIO(response.content))
newimage=image.resize((500,200))
"""
st.image(newimage,use_column_width=True)
image = Image.open('solubility-logo.jpg')
"""
st.image(image, use_column_width=True)

st.write("""
# Molecular Solubility Prediction Web App
This app predicts the **Solubility (LogS)** values of molecules!
Data obtained from the John S. Delaney. [ESOL:  Estimating Aqueous Solubility Directly from Molecular Structure](https://pubs.acs.org/doi/10.1021/ci034243x). ***J. Chem. Inf. Comput. Sci.*** 2004, 44, 3, 1000-1005.
***
""")


######################
# Input molecules (Side Panel)
######################

st.sidebar.header('User Input Features')

## Read SMILES input
SMILES_input = "NCCCC\nCCC\nCN"

SMILES = st.sidebar.text_area("SMILES input", SMILES_input)
SMILES = "C\n" + SMILES #Adds C as a dummy, first item
SMILES = SMILES.split('\n')

st.header('Input SMILES')
SMILES[1:] # Skips the dummy first item

## Calculate molecular descriptors
st.header('Computed molecular descriptors')
X = generate(SMILES)
X[1:] # Skips the dummy first item

######################
# Pre-built model
######################

# Reads in saved model
load_model = joblib.load("linearregressionmodel.joblib")

# Apply model to make predictions
prediction = load_model.predict(X)
#prediction_proba = load_model.predict_proba(X)

st.header('Predicted LogS values')
prediction[1:] # Skips the dummy first item
